From what I understand, the program does not give correct results and counts more letters than it should.
Apparently it has something to do with the 3rd bullet, which I never found the error.
More specifically I think something has to do with the frequency function in rows 93-109.